rule Contains_Hex_Encoded_PE_File
{
    meta:
        author = "Josh Stroschein (https://0xevilc0de.com)"
        description = "Detect a hex-encoded PE file"
        method = "Find string MZ followed by string PE within range after IMAGE_DOS_STUB"
    strings:
        $a = {34 64 35 61 [200-500] 35 30 34 35 30 30 30 30}
    condition:
        $a
}
